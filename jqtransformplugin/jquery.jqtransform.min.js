/*!
 * jqTransform (http://www.dfc-e.com/metiers/multimedia/opensource/jqtransform/)
 * by Mathieu Vilaplana mvilaplana@dfc-e.com
 * Designer Ghyslain Armand garmand@dfc-e.com
 * License: GPL
 ******************************************** */
(function(d){var f=function(i){var g=d(i.get(0).form),j=i.next(),h;if(!j.is("label")){j=i.prev();if(j.is("label")){h=i.attr("id");if(h){j=g.find('label[for="'+h+'"]')}}}if(j.is("label")){return j.css("cursor","pointer")}return false},e=function(g){var h=d(".jqTransformSelectWrapper ul:visible");h.each(function(){var i=d(this).parents(".jqTransformSelectWrapper:first").find("select").get(0);if(!(g&&i.oLabel&&i.oLabel.get(0)==g.get(0))){d(this).trigger("collapse")}})},a=function(g){if(d(g.target).parents(".jqTransformSelectWrapper").length===0){e(d(g.target))}},b=function(){d(document).mousedown(a)},c=function(h){var g;d(".jqTransformSelectWrapper select",h).each(function(){g=(this.selectedIndex<0)?0:this.selectedIndex;d("ul",d(this).parent()).each(function(){d("a:eq("+g+")",this).click()})});d("a.jqTransformCheckbox, a.jqTransformRadio",h).removeClass("jqTransformChecked");d("input:checkbox, input:radio",h).each(function(){if(this.checked){d("a",d(this).parent()).addClass("jqTransformChecked")}})};d.fn.jqTransInputButton=function(){return this.each(function(){var h=d(this),g=d('<button id="'+this.id+'" name="'+this.name+'" type="'+this.type+'" class="'+this.className+' jqTransformButton"><span><span>'+h.attr("value")+"</span></span>").hover(function(){g.addClass("jqTransformButton_hover")},function(){g.removeClass("jqTransformButton_hover")}).mousedown(function(){g.addClass("jqTransformButton_click")}).mouseup(function(){g.removeClass("jqTransformButton_click")});h.replaceWith(g)})};d.fn.jqTransInputText=function(){return this.each(function(){var i=d(this),g=i.width(),h;$wrapper=i.parent().parent().parent();if(i.hasClass("jqtranformdone")||!i.is("input")){return}i.addClass("jqtranformdone");h=f(i);h&&h.bind("click",function(){i.focus()});if(i.attr("size")){g=i.attr("size")*10;i.css("width",g)}i.addClass("jqTransformInput").wrap('<div class="jqTransformInputWrapper"><div class="jqTransformInputInner"><div></div></div></div>');$wrapper.css("width",g+10);i.focus(function(){$wrapper.addClass("jqTransformInputWrapper_focus")}).blur(function(){$wrapper.removeClass("jqTransformInputWrapper_focus")}).hover(function(){$wrapper.addClass("jqTransformInputWrapper_hover")},function(){$wrapper.removeClass("jqTransformInputWrapper_hover")});d.browser.safari&&$wrapper.addClass("jqTransformSafari");d.browser.safari&&i.css("width",$wrapper.width()+16);this.wrapper=$wrapper})};d.fn.jqTransCheckBox=function(){return this.each(function(){var g=d(this),i=d('<a href="#" class="jqTransformCheckbox"></a>'),h;if(g.hasClass("jqTransformHidden")){return}h=f(g);h&&h.click(function(){i.trigger("click")});g.addClass("jqTransformHidden").wrap('<span class="jqTransformCheckboxWrapper"></span>').parent().prepend(i);g.change(function(){this.checked&&i.addClass("jqTransformChecked")||i.removeClass("jqTransformChecked");return true});i.click(function(){if(g.attr("disabled")){return false}g.trigger("click").trigger("change");return false});this.checked&&i.addClass("jqTransformChecked")})};d.fn.jqTransRadio=function(){return this.each(function(){var g=d(this),i=this,h=d('<a href="#" class="jqTransformRadio" rel="'+this.name+'"></a>');if(g.hasClass("jqTransformHidden")){return}oLabel=f(g);oLabel&&oLabel.click(function(){h.trigger("click")});g.addClass("jqTransformHidden").wrap('<span class="jqTransformRadioWrapper"></span>').parent().prepend(h);g.change(function(){i.checked&&h.addClass("jqTransformChecked")||h.removeClass("jqTransformChecked");return true});h.click(function(j){j.preventDefault();if(g.attr("disabled")){return false}g.trigger("click").trigger("change");d('input[name="'+g.attr("name")+'"]',i.form).not(g).each(function(){d(this).attr("type")=="radio"&&d(this).trigger("change")})});i.checked&&h.addClass("jqTransformChecked")})};d.fn.jqTransTextarea=function(){return this.each(function(){var i=d(this),h='<table cellspacing="0" cellpadding="0" border="0" class="jqTransformTextarea">',g;if(i.hasClass("jqtransformdone")){return}i.addClass("jqtransformdone");oLabel=f(i);oLabel&&oLabel.click(function(){i.focus()});h+='<tr><td id="jqTransformTextarea-tl"></td><td id="jqTransformTextarea-tm"></td><td id="jqTransformTextarea-tr"></td></tr>';h+='<tr><td id="jqTransformTextarea-ml">&nbsp;</td><td id="jqTransformTextarea-mm"><div></div></td><td id="jqTransformTextarea-mr">&nbsp;</td></tr>';h+='<tr><td id="jqTransformTextarea-bl"></td><td id="jqTransformTextarea-bm"></td><td id="jqTransformTextarea-br"></td></tr>';h+="</table>";g=d(h).insertAfter(i).hover(function(){!g.hasClass("jqTransformTextarea-focus")&&g.addClass("jqTransformTextarea-hover")},function(){g.removeClass("jqTransformTextarea-hover")});i.focus(function(){g.removeClass("jqTransformTextarea-hover").addClass("jqTransformTextarea-focus")}).blur(function(){g.removeClass("jqTransformTextarea-focus")}).appendTo(d("#jqTransformTextarea-mm div",g));this.oTable=g;if(d.browser.safari){d("#jqTransformTextarea-mm",g).addClass("jqTransformSafariTextarea").find("div").css("height",i.height()).css("width",i.width())}})};d.fn.jqTransSelect=function(){if(this.length){this.each(function(n){var j=d(this),o=f(j),m,k,i,g,l,h,p,q;if(j.hasClass("jqTransformHidden")||j.attr("multiple")){return}m=j.addClass("jqTransformHidden").wrap('<div class="jqTransformSelectWrapper"></div>').parent().css({zIndex:99-n});m.prepend('<div><span></span><a href="#" class="jqTransformSelectOpen"></a></div><ul></ul>');k=d("ul",m).css("width",j.width()).hide();d("option",this).each(function(r){var s=d('<li><a href="#" index="'+r+'">'+d(this).html()+"</a></li>");k.append(s)});k.bind("collapse",function(){d(this).hide();var r=m.data("clone");if(r){m.attr("style",r.attr("style"));r.hide();m.insertAfter(r)}});k.find("a").click(function(s){s.preventDefault();var t=d(this),r;d("a.selected",m).removeClass("selected");t.addClass("selected");r=j[0].selectedIndex;j[0].selectedIndex=d(this).attr("index");if(r!=j[0].selectedIndex){j.change()}d("span:eq(0)",m).html(t.html());k.trigger("collapse")});d("a:eq("+this.selectedIndex+")",k).click();i=d("a.jqTransformSelectOpen",m);d("span:first",m).click(function(){i.trigger("click")});o&&o.click(function(){i.trigger("click")});this.oLabel=o;i.click(function(r){r.preventDefault();var t=k.is(":visible"),s;e();if(!t){if(j.attr("disabled")){return}k.css({width:(m.width()-i.width()-1)+"px"});k.slideToggle("fast",function(){var u=(d("a.selected",k).offset().top-k.offset().top);k.animate({scrollTop:u})});if(!m.data("clone")){s=m.clone().hide().insertBefore(m);m.data("clone",s)}else{s=m.data("clone")}s.show();m.appendTo("body").css({position:"absolute",top:s.offset().top,left:s.offset().left,width:s.width()+"px",height:s.height()+"px"})}});g=j.outerWidth();l=d("span:first",m);h=(g>l.innerWidth())?g+i.outerWidth():m.width();m.css({width:h});k.css({display:"block",visibility:"hidden"});if(k.is(":hidden")){p=d(k.parentsUntil(":visible").get().reverse());p.each(function(){var r=d(this);if(r.is(":hidden")){r.data("style",r.attr("style")||false);r.css({position:"absolute",left:"-10000px",display:"block"})}})}q=(d("li",k).length)*(d("li:first",k).height());(q<k.height())&&k.css({height:q,overflow:"hidden"});k.css({display:"none",visibility:"visible"});if(p){p.each(function(){var r=d(this);if(typeof r.data("style")!="undefined"){r.attr("style",r.data("style")||"")}})}});b()}return this};d.fn.jqTransform=function(){return this.each(function(){var g=d(this);if(g.hasClass("jqtransformdone")){return}g.addClass("jqtransformdone");d('input:submit, input:reset, input[type="button"]',this).jqTransInputButton();d("input:text, input:password",this).jqTransInputText();d("input:checkbox",this).jqTransCheckBox();d("input:radio",this).jqTransRadio();d("textarea",this).jqTransTextarea();d("select",this).jqTransSelect();g.bind("reset",function(){var h=function(){c(this)};window.setTimeout(h,10)})})}})(jQuery);